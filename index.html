<!DOCTYPE html>

<html lang="en">
<head>
<!-- CHOMAGE SECTION !-->
    <style>
	    .content {
	            max-width: 800px;
	            margin: auto;
	            padding: 16px 32px;
            }

            .ageSelect{
	            margin:auto;
	            width: 130px;
	            height: 40px;
	            border-radius: 8px;
            }
			#chartdiv {
		  width: 70%;
		  height: 400px;
		}
	</style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
	<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
	<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
	<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
	<script src="//www.amcharts.com/lib/4/themes/material.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	
    <title>Confi-Impact</title>
</head>
<body>
    

			<div class="content">
				<div class="toolbar">
					<select name="age" id="age" onchange="ChangeChart()" class="ageSelect">
						<option value="">section d'age</option>
						<option value="moins 25 ans">moins 25 ans</option>
						<option value="plus 25 ans">plus 25 ans</option>
						<option value="tous">tous</option>
					</select>
				</div>
				<div class="wrapper">
					<canvas id="myChart" ></canvas>
				</div>
			</div>
		
<script>

am4core.ready(function() {


	var chart = am4core.create("chartdiv", am4charts.XYChart);
	
	am4core.useTheme(am4themes_animated);
	chart.dataSource.url = "https://raw.githubusercontent.com/IsmailBarkani/COD/master/JSON/PIB(1).json?token=AN64LFGWCMVYDV667PKEDX27PINS6";
	chart.dataSource.parser = new am4core.JSONParser();
	chart.dataSource.parser.options.emptyAs = 0;
	
  
	let categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
	categoryAxis.dataFields.category = "Time";
	categoryAxis.title.text = "Trimestre";

	let valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
	valueAxis.title.text = "PIB Trimestriel en Milliard d'euros";

	

	var series2 = chart.series.push(new am4charts.LineSeries());
	series2.name = "Units";
	series2.stroke = am4core.color("#CDA2AB");
	series2.strokeWidth = 3;
	series2.dataFields.valueY = "PIB Trim";
	series2.dataFields.categoryX = "Time";
	series2.strokeWidth = 5;
	series2.minBulletDistance = 10;
	series2.tooltipText = "{valueY}";
	series2.stroke = am4core.color("#6495ED");
	series2.tooltip.pointerOrientation = "vertical";
	series2.tooltip.background.cornerRadius = 20;
	series2.tooltip.background.fillOpacity = 0.5;
	series2.tooltip.label.padding(12,12,12,12);
	//series2.defaultState.transitionDuration = 3000;
	series2.hiddenState.transitionDuration = 3000;
	series2.interpolationDuration = 5000;

	chart.scrollbarX = new am4charts.XYChartScrollbar();
	chart.scrollbarX.series.push(series2);

	
	chart.cursor = new am4charts.XYCursor();
	//chart.cursor.xAxis = dateAxis;
	chart.cursor.snapToSeries = series2;
	chart.defaults.global.animationSteps = 600;
	

	chart.responsive.useDefault = false
	chart.responsive.enabled = true;


	
});

</script>
<!-- HTML -->
<div id="chartdiv"></div>
	<script>
		var labels = [];
		var dataT = [];
		var dataH = [];
		var dataF = [];
		var dataTJ= [];
		var dataHJ = [];
		var dataHV = [];
		var dataTV= [];
		var dataFJ = [];
		var dataFV = [];
	
	$.getJSON("https://raw.githubusercontent.com/IsmailBarkani/COD/master/JSON/Chomage.json?token=AOJP73CFGICABNPDTJUCVKK7PIUKA", function(data) {
	
	$.each(data, function(index, record) {
		labels.push(record.Date);
		var switcher = 0;
		$.each(record.Data, function(key, value) {
			switch (switcher)
			{
				case 0 : 
					dataT.push(value.Total);
					dataH.push(Number((value.Total * value[Object.keys(value)[2]]).toFixed(2)));
					dataF.push(Number((value.Total * value[Object.keys(value)[3]]).toFixed(2)));
					switcher++;
					break;
				case 1:
					dataTJ.push(value.Total);
					dataHJ.push(Number((value.Total * value[Object.keys(value)[2]]).toFixed(2)));
					dataFJ.push(Number((value.Total * value[Object.keys(value)[3]]).toFixed(2)));
					switcher++;
					break;	
				case 2:
					dataTV.push(value.Total);
					dataHV.push(Number((value.Total * value[Object.keys(value)[2]]).toFixed(2)));
					dataFV.push(Number((value.Total * value[Object.keys(value)[3]]).toFixed(2)));
					switcher++;
					break;	
			}
			
		});
	});
   
	});
	var ctx = document.getElementById('myChart').getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'line',
      "data": {
         labels: labels,
         datasets: [
		 {
			label:'Homme',
            backgroundColor: 'rgba(54, 162, 235,0.8)',
            borderColor: 'rgb(54, 162, 235)',
			pointBorderColor: 'rgba(17,50,96,0.7)',
			pointBackgroundColor: 'rgba(80,120,200,0.8)',
			pointBorderWidth: 1,
			pointHoverRadius:5,
			fill : false,
			hidden : true,
            data: dataH
         },
		 {
			label:'Femme',
            backgroundColor: 'rgba(255, 99, 132,0.8)',
            borderColor: 'rgb(255, 99, 132)',
			pointBorderColor: 'rgba(250,70,100,0.7)',
			pointBackgroundColor: 'rgba(255,190,200,0.8)',
			pointBorderWidth: 1,
			pointHoverRadius:5,
			fill : false,
			hidden : true,
            data: dataF
         },
		 {
			label:'Tous',
            backgroundColor: 'rgba(42, 73, 45,0.4)',
            borderColor: 'rgb(42, 73, 45)',
			borderDash: [],
			pointBorderColor: 'rgba(90, 150, 160,0.7)',
			pointBackgroundColor: 'rgba(120, 150, 160,0.8)',
			pointBorderWidth: 3,
			pointHoverRadius:5,
			pointRadius: 2,
			pointHitRadius: 10,
			fill : false,
            data: dataT
		 }
		 ]
      },
      options: {
         responsive: 'true',
		 title: {
			text: 'Impact du confinement sur le chômage en France',
			display: true
		 },
		 scales: {
					xAxes: [{
						scaleLabel: {
							display: true,
							labelString: 'Mois'
						}
					}],
					yAxes: [{
						scaleLabel: {
							display: true,
							labelString: 'Chômage (en Milliers)'
						}
					}]
				}
      }
		});
		/* THIS IS HOW TO CONTROL CHART SIZE*/
		myChart.canvas.parentNode.style.height = '800px';
		myChart.canvas.parentNode.style.width = '850px';
	</script>
	<script>
		function ChangeChart(){
			var age = document.getElementById("age").value;
			switch(age)
			{
				case "moins 25 ans":
					myChart.config.data.datasets[0].data = dataHJ;
					myChart.config.data.datasets[1].data = dataFJ;
					myChart.config.data.datasets[2].data = dataTJ;
					break;
				case "plus 25 ans":
					myChart.config.data.datasets[0].data = dataHV;
					myChart.config.data.datasets[1].data = dataFV;
					myChart.config.data.datasets[2].data = dataTV;
					break;
				case "tous":
					myChart.config.data.datasets[0].data = dataH;
					myChart.config.data.datasets[1].data = dataF;
					myChart.config.data.datasets[2].data = dataT;
					break;
				default:
					break;
					
			}
			myChart.update();
			}
			</script>
	
    
</body>
</html>
